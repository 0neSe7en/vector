---
date: "2022-06-16"
title: "0.23 Upgrade Guide"
description: "An upgrade guide that addresses breaking changes in 0.23.0"
authors: ["akx", "jszwedko"]
release: "0.23.0"
hide_on_release_notes: false
badges:
  type: breaking change
---

Vector's 0.23.0 release includes **breaking changes**:

1. [The `.deb` package no longer enables and starts the Vector systemd service](#systemd-autostart)
2. [`syslog` source and VRL's `parse_syslog` structured data fields made consistent](#parse-syslog)

We cover them below to help you upgrade quickly:

## Upgrade guide

### Breaking changes

#### [The `.deb` package no longer enables and starts the Vector systemd service] {#systemd-autostart}

The [official `.deb` package](https://vector.dev/download/)
no longer automatically enables and starts the Vector systemd service.
This is in line with how the RPM package behaves.

To enable and start the service (after configuring it to your requirements),
you can use `systemctl enable --now`:

```shell
systemctl enable --now vector
```

To just start the service without enabling it to run at system startup,

```shell
systemctl start vector
```

#### `syslog` source and VRL's `parse_syslog` structured data fields made consistent {#parse-syslog}

Previously, the `parse_syslog` VRL function and the `syslog` source handled parsing the structured
data section of syslog messages differently:

- The `syslog` source inserted a field with the name of the structured data element, with the
  fields as keys in that map. It would create further nested maps if the structured data key names
  had `.`s in them.
- The `parse_syslog` function would instead prefix the structured data keys with the name of the
  structured data element they appeared in, but would insert this as a flat key/value structure
  rather than nesting (so that referencing keys would require quoting to escape the `.`s).

With this release the behavior of both is now to parse the structured data section as a flat map
of string key / string value, and insert it into the target under a field with the name of the
structured data element.

That is:

```
<1>1 2022-04-25T23:21:45.715740Z Gregorys-MacBook-Pro.local 2d4d9490-794a-4e60-814c-5597bd5b7b7d 79978 - [exampleSDID@32473 foo.baz="bar"] test message
```

Now returns (for both the `syslog` source and the `parse_syslog` function):

```json
{
  "appname": "2d4d9490-794a-4e60-814c-5597bd5b7b7d",
  "exampleSDID@32473": {
    "foo.baz": "bar"
  },
  "facility": "kern",
  "hostname": "Gregorys-MacBook-Pro.local",
  "message": "test message",
  "procid": 79978,
  "severity": "alert",
  "timestamp": "2022-04-25T23:21:45.715740Z",
  "version": 1
}
```

Where previously `parse_syslog` returned:

```json
{
  "appname": "2d4d9490-794a-4e60-814c-5597bd5b7b7d",
  "exampleSDID@32473.foo.baz": "bar",
  "facility": "kern",
  "hostname": "Gregorys-MacBook-Pro.local",
  "message": "test message",
  "procid": 79978,
  "severity": "alert",
  "timestamp": "2022-04-25T23:21:45.715740Z",
  "version": 1
}
```

And the `syslog` source returned:

```json
{
  "appname": "2d4d9490-794a-4e60-814c-5597bd5b7b7d",
  "exampleSDID@32473": {
    "foo": {
      "baz": "bar"
    }
  },
  "facility": "kern",
  "hostname": "Gregorys-MacBook-Pro.local",
  "message": "test message",
  "procid": 79978,
  "severity": "alert",
  "timestamp": "2022-04-25T23:21:45.715740Z",
  "version": 1
}
```


The previous `parse_syslog` behavior can be acheived by running the result through the `flatten`
function like:

```
flatten(parse_syslog!(s'<1>1 2022-04-25T23:21:45.715740Z Gregorys-MacBook-Pro.local 2d4d9490-794a-4e60-814c-5597bd5b7b7d 79978 - [exampleSDID@32473 foo.baz="bar"] test message'))

name = "Sudo"

[[transforms]]
type = "remap"
source = '''
. |= parse_grok(
    value: .message,
    pattern: "%{_sudo_user} : %{_sudo_tty}( %{_sudo_pwd})? %{_sudo_run_as_user}( %{_sudo_group})?( %{_sudo_tsid})?( %{_sudo_env})? (%{_sudo_command})?; (%{_sudo_lang} )?(%{_sudo_lc_type} )?.*",
    aliases: {
        _sudo_user: "%{notSpace:system.user}",
        _sudo_tty: "TTY=%{notSpace:system.tty} ;",
        _sudo_pwd: "PWD=%{notSpace:system.pwd} ;",
        _sudo_run_as_user: "USER=%{notSpace:system.run_as_user} ;",
        _sudo_group: "GROUP=%{notSpace:system.run_as_group} ;",
        _sudo_tsid: "TSID=%{notSpace:system.tsid} ;",
        _sudo_env: "ENV=%{data:system.env}",
        _sudo_command: "COMMAND=%{data:system.cmd}",
        _sudo_lang: "LANG=%{notSpace:system.lang}",
        _sudo_lc_type: "LC_CTYPE=%{notSpace:system.lc_type}"
    }
)
'''
